import { GraphQL } from "./graphql.js";
export class Dropdown {
    constructor(dropdownNodeOrId) {
        if (dropdownNodeOrId instanceof HTMLDivElement)
            this.dropdownNode = dropdownNodeOrId;
        else
            this.dropdownNode = document.getElementById(dropdownNodeOrId);
        if (!this.dropdownNode)
            throw "The dropdown node is null. Parameter given was: " + dropdownNodeOrId;
        // For now, we only support Fomantic UI style, since I doubt it'll be replaced anytime soon.
        this.inputNode = this.dropdownNode.querySelector("div.dropdown input[type=hidden]");
        if (!this.inputNode)
            throw "Could not find the input element. Is your markup in Fomantic UI style?";
        this.menuNode = this.dropdownNode.querySelector("div.dropdown div.menu");
        if (!this.menuNode)
            throw "Could not find the menu element. Is your markup in Fomantic UI style?";
        this.defaultValue = this.inputNode.dataset.defaultValue;
        const refreshButton = this.dropdownNode.querySelector("label .button[data-type=refresh]");
        refreshButton.addEventListener("click", () => this.refresh());
        // Just to make sure Fomantic UI knows about it, saving the user the hassle.
        $(this.menuNode.parentNode).dropdown({ forceSelection: false });
        this._refreshFunc = function () { alert("No refresh function has been assigned."); };
    }
    // FUNCTIONS TO MANIPULATE ITEMS
    addItem(
    // Gotta love TS' syntax.
    { name, value = null, isSelected = false }) {
        const item = this.menuNode.appendChild(document.createElement("div"));
        item.classList.add("item");
        item.innerText = name;
        if (value)
            item.dataset.value = value;
        if (isSelected)
            $(this.menuNode.parentNode).dropdown("set selected", value || name);
        return item;
    }
    clear() {
        while (this.menuNode.firstChild)
            this.menuNode.removeChild(this.menuNode.firstChild);
    }
    refresh() {
        this._refreshFunc();
    }
    // GENERIC DATA SOURCES
    fromRefreshFunc(func) {
        this._refreshFunc = func;
    }
    fromGraphQL({ query, parameters = null, dataGetter }) {
        this.fromRefreshFunc(() => {
            GraphQL
                .query(query, parameters)
                .then((data) => {
                this.clear();
                const nameValuePairs = dataGetter(data);
                for (const pair of nameValuePairs)
                    this.addItem({ name: pair.name, value: pair.value, isSelected: pair.value == this.defaultValue });
            })
                .catch((reason) => {
                alert("TEMP error handling: " + JSON.stringify(reason));
            });
        });
        this.refresh();
        this.refresh(); // Very weird bug where, during the first refresh, Fomantic UI won't perform "set selected" correctly.
    }
    // COMMON DROPDOWN DATA SOURCES
    //
    // If the data source is used in more than one page, its probably best to put it here.
    fromNameIdGraphQL(entityName) {
        this.fromGraphQL({
            query: `query GetOwners {
                ${entityName} {
                    id
                    name
                }
            }`,
            dataGetter: (json) => json[entityName].map(function (v) {
                return { name: v.name, value: String(v.id) };
            })
        });
    }
    fromContactGraphQL() {
        this.fromNameIdGraphQL("contacts");
    }
    fromSpeciesGraphQL() {
        this.fromNameIdGraphQL("species");
    }
}
export default Dropdown;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHJvcGRvd24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9TY3JpcHRzL2Ryb3Bkb3duLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxjQUFjLENBQUE7QUFFdEMsTUFBTSxPQUFPLFFBQVE7SUFPakIsWUFBWSxnQkFBeUM7UUFDakQsSUFBSSxnQkFBZ0IsWUFBWSxjQUFjO1lBQzFDLElBQUksQ0FBQyxZQUFZLEdBQUcsZ0JBQWdCLENBQUM7O1lBRXJDLElBQUksQ0FBQyxZQUFZLEdBQW1CLFFBQVEsQ0FBQyxjQUFjLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUVsRixJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVk7WUFDbEIsTUFBTSxrREFBa0QsR0FBRyxnQkFBZ0IsQ0FBQztRQUVoRiw0RkFBNEY7UUFDNUYsSUFBSSxDQUFDLFNBQVMsR0FBcUIsSUFBSSxDQUFDLFlBQVksQ0FBQyxhQUFhLENBQUMsaUNBQWlDLENBQUMsQ0FBQztRQUN0RyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVM7WUFDZixNQUFNLHdFQUF3RSxDQUFDO1FBRW5GLElBQUksQ0FBQyxRQUFRLEdBQW1CLElBQUksQ0FBQyxZQUFZLENBQUMsYUFBYSxDQUFDLHVCQUF1QixDQUFDLENBQUM7UUFDekYsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRO1lBQ2QsTUFBTSx1RUFBdUUsQ0FBQztRQUVsRixJQUFJLENBQUMsWUFBWSxHQUFXLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQztRQUVoRSxNQUFNLGFBQWEsR0FBZ0IsSUFBSSxDQUFDLFlBQVksQ0FBQyxhQUFhLENBQUMsa0NBQWtDLENBQUMsQ0FBQztRQUN2RyxhQUFhLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBRTlELDRFQUE0RTtRQUM1RSxDQUFDLENB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LE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDO1lBQ2pELENBQUMsQ0FBQztTQUNMLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFTSxrQkFBa0I7UUFDckIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7SUFFTSxrQkFBa0I7UUFDckIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ3RDLENBQUM7Q0FDSjtBQUVELGVBQWUsUUFBUSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR3JhcGhRTCB9IGZyb20gXCIuL2dyYXBocWwuanNcIlxyXG5cclxuZXhwb3J0IGNsYXNzIERyb3Bkb3duIHtcclxuICAgIHB1YmxpYyByZWFkb25seSBkcm9wZG93bk5vZGU6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAgcHVibGljIHJlYWRvbmx5IGlucHV0Tm9kZTogSFRNTElucHV0RWxlbWVudDtcclxuICAgIHB1YmxpYyByZWFkb25seSBtZW51Tm9kZTogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICBwdWJsaWMgcmVhZG9ubHkgZGVmYXVsdFZhbHVlOiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIF9yZWZyZXNoRnVuYzogRnVuY3Rpb247XHJcblxyXG4gICAgY29uc3RydWN0b3IoZHJvcGRvd25Ob2RlT3JJZDogSFRNTERpdkVsZW1lbnQgfCBzdHJpbmcpIHtcclxuICAgICAgICBpZiAoZHJvcGRvd25Ob2RlT3JJZCBpbnN0YW5jZW9mIEhUTUxEaXZFbGVtZW50KVxyXG4gICAgICAgICAgICB0aGlzLmRyb3Bkb3duTm9kZSA9IGRyb3Bkb3duTm9kZU9ySWQ7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB0aGlzLmRyb3Bkb3duTm9kZSA9IDxIVE1MRGl2RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChkcm9wZG93bk5vZGVPcklkKTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmRyb3Bkb3duTm9kZSlcclxuICAgICAgICAgICAgdGhyb3cgXCJUaGUgZHJvcGRvd24gbm9kZSBpcyBudWxsLiBQYXJhbWV0ZXIgZ2l2ZW4gd2FzOiBcIiArIGRyb3Bkb3duTm9kZU9ySWQ7XHJcblxyXG4gICAgICAgIC8vIEZvciBub3csIHdlIG9ubHkgc3VwcG9ydCBGb21hbnRpYyBVSSBzdHlsZSwgc2luY2UgSSBkb3VidCBpdCdsbCBiZSByZXBsYWNlZCBhbnl0aW1lIHNvb24uXHJcbiAgICAgICAgdGhpcy5pbnB1dE5vZGUgPSA8SFRNTElucHV0RWxlbWVudD50aGlzLmRyb3Bkb3duTm9kZS5xdWVyeVNlbGVjdG9yKFwiZGl2LmRyb3Bkb3duIGlucHV0W3R5cGU9aGlkZGVuXVwiKTtcclxuICAgICAgICBpZiAoIXRoaXMuaW5wdXROb2RlKVxyXG4gICAgICAgICAgICB0aHJvdyBcIkNvdWxkIG5vdCBmaW5kIHRoZSBpbnB1dCBlbGVtZW50LiBJcyB5b3VyIG1hcmt1cCBpbiBGb21hbnRpYyBVSSBzdHlsZT9cIjtcclxuXHJcbiAgICAgICAgdGhpcy5tZW51Tm9kZSA9IDxIVE1MRGl2RWxlbWVudD50aGlzLmRyb3Bkb3duTm9kZS5xdWVyeVNlbGVjdG9yKFwiZGl2LmRyb3Bkb3duIGRpdi5tZW51XCIpO1xyXG4gICAgICAgIGlmICghdGhpcy5tZW51Tm9kZSlcclxuICAgICAgICAgICAgdGhyb3cgXCJDb3VsZCBub3QgZmluZCB0aGUgbWVudSBlbGVtZW50LiBJcyB5b3VyIG1hcmt1cCBpbiBGb21hbnRpYyBVSSBzdHlsZT9cIjtcclxuXHJcbiAgICAgICAgdGhpcy5kZWZhdWx0VmFsdWUgPSA8c3RyaW5nPnRoaXMuaW5wdXROb2RlLmRhdGFzZXQuZGVmYXVsdFZhbHVlO1xyXG5cclxuICAgICAgICBjb25zdCByZWZyZXNoQnV0dG9uID0gPEhUTUxFbGVtZW50PnRoaXMuZHJvcGRvd25Ob2RlLnF1ZXJ5U2VsZWN0b3IoXCJsYWJlbCAuYnV0dG9uW2RhdGEtdHlwZT1yZWZyZXNoXVwiKTtcclxuICAgICAgICByZWZyZXNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLnJlZnJlc2goKSk7XHJcblxyXG4gICAgICAgIC8vIEp1c3QgdG8gbWFrZSBzdXJlIEZvbWFudGljIFVJIGtub3dzIGFib3V0IGl0LCBzYXZpbmcgdGhlIHVzZXIgdGhlIGhhc3NsZS5cclxuICAgICAgICAkKDxhbnk+dGhpcy5tZW51Tm9kZS5wYXJlbnROb2RlKS5kcm9wZG93bih7IGZvcmNlU2VsZWN0aW9uOiBmYWxzZSB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5fcmVmcmVzaEZ1bmMgPSBmdW5jdGlvbiAoKSB7IGFsZXJ0KFwiTm8gcmVmcmVzaCBmdW5jdGlvbiBoYXMgYmVlbiBhc3NpZ25lZC5cIik7IH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRlVOQ1RJT05TIFRPIE1BTklQVUxBVEUgSVRFTVNcclxuXHJcbiAgICBwdWJsaWMgYWRkSXRlbShcclxuICAgICAgICAvLyBHb3R0YSBsb3ZlIFRTJyBzeW50YXguXHJcbiAgICAgICAgeyBuYW1lLCAgICAgICAgIHZhbHVlID0gbnVsbCwgICAgICAgICAgaXNTZWxlY3RlZCA9IGZhbHNlIH06XHJcbiAgICAgICAgeyBuYW1lOiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nIHwgbnVsbCwgaXNTZWxlY3RlZDogYm9vbGVhbiB9XHJcbiAgICApOiBIVE1MRGl2RWxlbWVudCB7XHJcbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMubWVudU5vZGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSk7XHJcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKFwiaXRlbVwiKTtcclxuICAgICAgICBpdGVtLmlubmVyVGV4dCA9IG5hbWU7XHJcblxyXG4gICAgICAgIGlmICh2YWx1ZSlcclxuICAgICAgICAgICAgaXRlbS5kYXRhc2V0LnZhbHVlID0gdmFsdWU7XHJcblxyXG4gICAgICAgIGlmIChpc1NlbGVjdGVkKVxyXG4gICAgICAgICAgICAkKDxhbnk+dGhpcy5tZW51Tm9kZS5wYXJlbnROb2RlKS5kcm9wZG93bihcInNldCBzZWxlY3RlZFwiLCB2YWx1ZSB8fCBuYW1lKVxyXG5cclxuICAgICAgICByZXR1cm4gaXRlbTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xlYXIoKSB7XHJcbiAgICAgICAgd2hpbGUgKHRoaXMubWVudU5vZGUuZmlyc3RDaGlsZClcclxuICAgICAgICAgICAgdGhpcy5tZW51Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLm1lbnVOb2RlLmZpcnN0Q2hpbGQpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyByZWZyZXNoKCkge1xyXG4gICAgICAgIHRoaXMuX3JlZnJlc2hGdW5jKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR0VORVJJQyBEQVRBIFNPVVJDRVNcclxuXHJcbiAgICBwdWJsaWMgZnJvbVJlZnJlc2hGdW5jKGZ1bmM6IEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5fcmVmcmVzaEZ1bmMgPSBmdW5jO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBmcm9tR3JhcGhRTChcclxuICAgICAgICB7IHF1ZXJ5LCAgICAgICAgIHBhcmFtZXRlcnMgPSBudWxsLCAgICAgICAgICBkYXRhR2V0dGVyIH06XHJcbiAgICAgICAgeyBxdWVyeTogc3RyaW5nLCBwYXJhbWV0ZXJzPzogb2JqZWN0IHwgbnVsbCwgZGF0YUdldHRlcjogKGRhdGE6IGFueSkgPT4geyBuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfVtdIH1cclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuZnJvbVJlZnJlc2hGdW5jKCgpID0+IHtcclxuICAgICAgICAgICAgR3JhcGhRTFxyXG4gICAgICAgICAgICAgICAgLnF1ZXJ5KHF1ZXJ5LCBwYXJhbWV0ZXJzKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVWYWx1ZVBhaXJzID0gZGF0YUdldHRlcihkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHBhaXIgb2YgbmFtZVZhbHVlUGFpcnMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkSXRlbSh7IG5hbWU6IHBhaXIubmFtZSwgdmFsdWU6IHBhaXIudmFsdWUsIGlzU2VsZWN0ZWQ6IHBhaXIudmFsdWUgPT0gdGhpcy5kZWZhdWx0VmFsdWUgfSk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKChyZWFzb24pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIlRFTVAgZXJyb3IgaGFuZGxpbmc6IFwiICsgSlNPTi5zdHJpbmdpZnkocmVhc29uKSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnJlZnJlc2goKTtcclxuICAgICAgICB0aGlzLnJlZnJlc2goKTsgLy8gVmVyeSB3ZWlyZCBidWcgd2hlcmUsIGR1cmluZyB0aGUgZmlyc3QgcmVmcmVzaCwgRm9tYW50aWMgVUkgd29uJ3QgcGVyZm9ybSBcInNldCBzZWxlY3RlZFwiIGNvcnJlY3RseS5cclxuICAgIH1cclxuXHJcbiAgICAvLyBDT01NT04gRFJPUERPV04gREFUQSBTT1VSQ0VTXHJcbiAgICAvL1xyXG4gICAgLy8gSWYgdGhlIGRhdGEgc291cmNlIGlzIHVzZWQgaW4gbW9yZSB0aGFuIG9uZSBwYWdlLCBpdHMgcHJvYmFibHkgYmVzdCB0byBwdXQgaXQgaGVyZS5cclxuXHJcbiAgICBwcml2YXRlIGZyb21OYW1lSWRHcmFwaFFMKGVudGl0eU5hbWU6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuZnJvbUdyYXBoUUwoe1xyXG4gICAgICAgICAgICBxdWVyeTogYHF1ZXJ5IEdldE93bmVycyB7XHJcbiAgICAgICAgICAgICAgICAke2VudGl0eU5hbWV9IHtcclxuICAgICAgICAgICAgICAgICAgICBpZFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfWAsXHJcblxyXG4gICAgICAgICAgICBkYXRhR2V0dGVyOiAoanNvbjogYW55KSA9PiBqc29uW2VudGl0eU5hbWVdLm1hcChmdW5jdGlvbiAodjogeyBuYW1lOiBzdHJpbmcsIGlkOiBzdHJpbmcgfSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgbmFtZTogdi5uYW1lLCB2YWx1ZTogU3RyaW5nKHYuaWQpIH07XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGZyb21Db250YWN0R3JhcGhRTCgpIHtcclxuICAgICAgICB0aGlzLmZyb21OYW1lSWRHcmFwaFFMKFwiY29udGFjdHNcIik7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGZyb21TcGVjaWVzR3JhcGhRTCgpIHtcclxuICAgICAgICB0aGlzLmZyb21OYW1lSWRHcmFwaFFMKFwic3BlY2llc1wiKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRHJvcGRvd247Il19