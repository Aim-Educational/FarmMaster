export var SaveRange;!function(e){e[e.no=0]="no",e[e.yes=1]="yes"}(SaveRange||(SaveRange={}));export class InputRange{map(e,t=SaveRange.yes){return new InputRangeMap(this,e,t)}filter(e,t=SaveRange.yes){return new InputRangeFilter(this,e,t)}any(e,t=SaveRange.yes){let n=t?this.save():this;for(;!n.empty;){let t=n.front;if(void 0===t)throw new RangeError("I returned an unexpected 'undefined'");if(e(t))return!0;n.popFront()}return!1}all(e,t=SaveRange.yes){let n=t?this.save():this;for(;!n.empty;){let t=n.front;if(void 0===t)throw new RangeError("I returned an unexpected 'undefined'");if(!e(t))return!1;n.popFront()}return!0}reduce(e,t,n=SaveRange.yes){let r=n?this.save():this;for(;!r.empty;){let n=r.front;if(void 0===n)throw new RangeError("I returned an unexpected 'undefined'");e=t(e,n),r.popFront()}return e}then(e,t=SaveRange.yes){return e(t?this.save():this)}thenSingle(e,t=SaveRange.yes){return e(t?this.save():this)}get walkLength(){return this.walkLengthUpTo(Number.MAX_VALUE)}walkLengthUpTo(e){if(this.empty||e<0)return 0;let t=this.save(),n=0;for(;!(t.empty||(t.popFront(),n++,void 0!==e&&n>=e)););return n}[Symbol.iterator](){return this.save()}next(){if(this.empty)return{done:!0,value:void 0};let e=this.front;return this.popFront(),{done:!1,value:e}}}export function drange(e){if(e instanceof Array)return new InputRangeArrayWrapper(e);if(e instanceof NodeList)return new InputRangeNodeListWrapper(e);throw TypeError("Don't know how to wrap type: "+typeof e)}export class InputRangeNodeListWrapper extends InputRange{constructor(e,t=0){super(),this._wrapped=e,this._index=t}get empty(){return this._index>=this._wrapped.length}get front(){let e=this._wrapped.item(this._index);return null!==e?e:void 0}popFront(){if(this.empty)throw new RangeError("Cannot pop an empty range.");this._index++}save(){return new InputRangeNodeListWrapper(this._wrapped,this._index)}}export class InputRangeArrayWrapper extends InputRange{constructor(e,t=0){super(),this._wrapped=e,this._index=t}get empty(){return this._index>=this._wrapped.length}get front(){let e=this._wrapped[this._index];return null!==e?e:void 0}popFront(){if(this.empty)throw new RangeError("Cannot pop an empty range.");this._index++}save(){return new InputRangeArrayWrapper(this._wrapped,this._index)}}class InputRangeMap extends InputRange{constructor(e,t,n=SaveRange.yes){super(),this._range=e,this._func=t,this._save=n,this._save&&(this._range=this._range.save())}get empty(){return this._range.empty}get front(){return this._range.front?this._func(this._range.front):void 0}popFront(){if(this.empty)throw new RangeError("Cannot pop an empty range.");this._range.popFront()}save(){return new InputRangeMap(this._range,this._func)}}class InputRangeFilter extends InputRange{constructor(e,t,n=SaveRange.yes){super(),this._range=e,this._func=t,this._save=n,this._forcePop=!1,this._save&&(this._range=this._range.save()),this.empty||this.popFront()}get empty(){return this._range.empty}get front(){return this._range.front}popFront(){if(this.empty)throw new RangeError("Cannot pop an empty range.");for(this._forcePop&&this._range.popFront(),this._forcePop=!0;!this.empty;){let e=this._range.front;if(!e)throw new RangeError("Inner range unexpectedly returned 'undefined'");if(this._func(e))break;this._range.popFront()}}save(){return new InputRangeFilter(this._range,this._func)}}